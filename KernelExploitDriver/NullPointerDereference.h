#ifndef __H_NULLPOINTERDEREFERENCE_H__
#define __H_NULLPOINTERDEREFERENCE_H__

#include<ntddk.h>
#include "Common.h"

typedef void(*FunctionPointer)();

typedef struct _NULL_POINTER_DEREFERENCE
{
	ULONG_PTR ulptrValue;
	FunctionPointer Callback;
}NULL_POINTER_DEREFERENCE, *PNULL_POINTER_DEREFERENCE;

VOID NullPointerDereferenceObjectCallback();

NTSTATUS NTAPI
NullPointerDereferenceHandler(
	_In_ PIRP pIrp,
	_In_ PIO_STACK_LOCATION pStackLocation
);

#endif

